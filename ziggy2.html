<!DOCTYPE html>
<html>
<head>
<title>Project Ziggurat</title>
<meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
<meta charset="utf-8">
<!-- bootstrap, threejs, other libs (jquery?) -->
<script src="js/three.min.js"></script>
<script src="js/OrbitControls.js"></script>
<!-- <script src="demo.js"></script> -->

</head>
<body>
<div id='container'></div>
<!-- 
<div>
    <div id='renderSection' width='70%'>
        <p>Render some stuff here</p>
    </div>
    <div id='controlPanel'>
        <form>
            <label for='xSlider'>X Height</label>
        </form>
    </div>
</div> -->
<script type='text/javascript'>

    var camera, controls, scene, renderer;

    var topCube, midCube, botCube;

    // Set the scene size.
    var WIDTH = 400;
    var HEIGHT = 300;
    var ZVAL = 0;
    
    // Get the DOM element to attach to
    container =
        document.querySelector('#container');

    init2();
    render();

    updateZiggurat(20, 40, 60);
    function init2() {
        scene = new THREE.Scene();
        scene.background = new THREE.Color( 0xcccccc );

        renderer = new THREE.WebGLRenderer();
        renderer.setSize(window.innerWidth, window.innerHeight);

        var container = document.getElementById('container');
        container.appendChild(renderer.domElement);

        camera = new THREE.PerspectiveCamera(60, window.innerWidth / window.innerHeight, 1, 1000);
        camera.position.z = 300;

        controls = new THREE.OrbitControls(camera, renderer.domElement);
        controls.addEventListener('change', render);

        createStartingZiggurat(20, 20, 20);

        createLight();
        window.addEventListener( 'resize', onWindowResize, false );
    }

    function updateZiggurat(topHeight, midHeight, bottomHeight) {
        topCube.position.y = (topHeight + midHeight) / 2;
        topCube.geometry.parameters.height = topHeight;
        midCube.geometry.parameters.height = midHeight;
        lowCube.position.y = -((bottomHeight + midHeight) / 2);
        lowCube.geometry.parameters.height = bottomHeight;
        render();
    }

    function onWindowResize() {

        camera.aspect = window.innerWidth / window.innerHeight;
        camera.updateProjectionMatrix();

        renderer.setSize( window.innerWidth, window.innerHeight );

    }
    
    function createStartingZiggurat(topHeight, medHeight, lowHeight) {
        var topMaterial = new THREE.MeshBasicMaterial({
            color : 0x00ff00
        });

        var midMaterial = new THREE.MeshBasicMaterial({
            color : 0xff0000
        });

        var botMaterial = new THREE.MeshBasicMaterial({
            color : 0x0000ff
        });

        var TOPWIDTH = 20;
        var MIDWIDTH = 40;
        var BOTWIDTH = 60;

        var topGeometry = new THREE.CubeGeometry(TOPWIDTH, topHeight, TOPWIDTH)
        topCube = new THREE.Mesh(topGeometry, topMaterial);
        topCube.position.z = ZVAL;
        topCube.position.y = (topHeight + medHeight) / 2;
        scene.add(topCube);

        var medGeometry = new THREE.CubeGeometry(MIDWIDTH, medHeight, MIDWIDTH)
        midCube = new THREE.Mesh(medGeometry, midMaterial);
        midCube.position.z = ZVAL;
        midCube.position.y = 0;
        scene.add(midCube);

        var lowGeometry = new THREE.CubeGeometry(BOTWIDTH, lowHeight, BOTWIDTH)
        lowCube = new THREE.Mesh(lowGeometry, botMaterial);
        lowCube.position.z = ZVAL;
        lowCube.position.y = -((lowHeight + medHeight) / 2);
        scene.add(lowCube);
    }

    function createLight() {
            
        // create a point light
        var lights = [];
        lights[ 0 ] = new THREE.PointLight( 0xffffff, 1, 0 );
        lights[ 1 ] = new THREE.PointLight( 0xffffff, 1, 0 );
        lights[ 2 ] = new THREE.PointLight( 0xffffff, 1, 0 );

        lights[ 0 ].position.set( 0, 200, 0 );
        lights[ 1 ].position.set( 100, 200, 100 );
        lights[ 2 ].position.set( - 100, - 200, - 100 );

        scene.add( lights[ 0 ] );
        scene.add( lights[ 1 ] );
        scene.add( lights[ 2 ] );
    }

    function animate() {
        requestAnimationFrame(animate);
        controls.update();
        render()
    }

    function render() {
        renderer.render( scene, camera );
    }

</script>
</body>
</html>
